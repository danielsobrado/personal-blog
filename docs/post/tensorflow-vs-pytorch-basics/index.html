<!DOCTYPE html>
<html lang="en-US" />
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Tensorflow vs Pytorch: Basics &middot; </title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://www.danielsobrado.com/favicon.ico" />
    <link rel="canonical" href="https://www.danielsobrado.com/post/tensorflow-vs-pytorch-basics/" />

     <meta name="description" content="Arguably the most famous machine learning low-level frameworks. Pytorch created by Facebook and used as the foundation in projects like Uber&#39;s pyro and Tensorflow created by Google and widely used. Both frameworks are used by the research community and for advanced models that are not readily available in high-level libraries like Keras." /> 

     
    
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="https://i.imgur.com/k3fRAC4.jpg"/>
    
 
    <meta name="twitter:title" content="Tensorflow vs Pytorch: Basics"/>
    <meta name="twitter:description" content="Arguably the most famous machine learning low-level frameworks. Pytorch created by Facebook and used as the foundation in projects like Uber&#39;s pyro and Tensorflow created by Google and widely used. Both frameworks are used by the research community and for advanced models that are not readily available in high-level libraries like Keras."/>
    <meta name="twitter:url" content="https://www.danielsobrado.com/post/tensorflow-vs-pytorch-basics/" />
    <meta name="twitter:site" content="@DalamarBlog"/>

    <meta property="og:site_name" content="" />
    <meta property="og:title" content="Tensorflow vs Pytorch: Basics &middot; Daniel Sobrado" />
    <meta property="og:url" content="https://www.danielsobrado.com/post/tensorflow-vs-pytorch-basics/" />
    <meta property="article:publisher" content="https://www.facebook.com/j.daniel.sobrado" />

    <meta property="og:type" content="article" />
    <meta property="og:description" content="Arguably the most famous machine learning low-level frameworks. Pytorch created by Facebook and used as the foundation in projects like Uber&#39;s pyro and Tensorflow created by Google and widely used. Both frameworks are used by the research community and for advanced models that are not readily available in high-level libraries like Keras." />

    <meta property="article:published_time" content="2016-09-25T00:00:00Z" />
    <meta property="article:tag" content="Tensorflow" /><meta property="article:tag" content="Pytorch" />

    <meta property="og:image" content="https://i.imgur.com/k3fRAC4.jpg"/>


    <meta name="generator" content="Hugo 0.48" />

    <!-- Stylesheets -->
    
    <link rel="stylesheet" type="text/css" href="https://www.danielsobrado.com/css/atelier-heath-light.css" /> 
    <link rel="stylesheet" type="text/css" href="https://www.danielsobrado.com/css/prettify.css" /> 
    <link rel="stylesheet" type="text/css" href="https://www.danielsobrado.com/built/screen.css" /> 
    <link rel="stylesheet" type="text/css" href="https://www.danielsobrado.com/css/casper-two.css" /> 
     <link rel="stylesheet" href="https://www.danielsobrado.com/atelier-heath-light.css" />  <link rel="stylesheet" href="https://www.danielsobrado.com/prettify.css" /> 

     

</head>


<body class="post-template">
  <div class="site-wrapper"> 

<header class="site-header outer">
  <div class="inner">
    <nav class="site-nav">
      <div class="site-nav-left">
        <a class="site-nav-logo" href="#"><img src="https://www.danielsobrado.com/img/daniel-logo.png" alt="Daniel Sobrado" /></a>

        <ul class="nav" role="menu">
        
        
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/">Home</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/about/">About me</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/categories/data-science/">Data Science</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/categories/big-data/">Big Data</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/categories/programming/">Programming</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/categories/maths/">Maths</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/tags/wiki/">Wiki</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/tags/">Tags</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://www.danielsobrado.com/categories/others/">Others</a>
            </li>
        
      </ul></div>

      <div class="site-nav-right">
        <div class="social-links">
                    <a href="#" class="social-link" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M294.8 361.2l-122 0.1 0-26 122-0.1L294.8 361.2zM377.2 213.7L356.4 93.5l-25.7 4.5 20.9 120.2L377.2 213.7zM297.8 301.8l-121.4-11.2 -2.4 25.9 121.4 11.2L297.8 301.8zM305.8 267.8l-117.8-31.7 -6.8 25.2 117.8 31.7L305.8 267.8zM321.2 238l-105-62 -13.2 22.4 105 62L321.2 238zM346.9 219.7l-68.7-100.8 -21.5 14.7 68.7 100.8L346.9 219.7zM315.5 275.5v106.5H155.6V275.5h-20.8v126.9h201.5V275.5H315.5z"/></svg></a>
                    <a class="social-link social-link-fb" href="https://www.facebook.com/j.daniel.sobrado" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg></a>

                    <a class="social-link social-link-tw" href="https://twitter.com/DalamarBlog" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg></a>

                    <a class="social-link" href="https://github.com/danielsobrado" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>

                    <a class="social-link" href="https://www.linkedin.com/in/dsobrado" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 50 512 512"><path d="M150.65,100.682c0,27.992-22.508,50.683-50.273,50.683c-27.765,0-50.273-22.691-50.273-50.683 C50.104,72.691,72.612,50,100.377,50C128.143,50,150.65,72.691,150.65,100.682z M143.294,187.333H58.277V462h85.017V187.333z M279.195,187.333h-81.541V462h81.541c0,0,0-101.877,0-144.181c0-38.624,17.779-61.615,51.807-61.615 c31.268,0,46.289,22.071,46.289,61.615c0,39.545,0,144.181,0,144.181h84.605c0,0,0-100.344,0-173.915 s-41.689-109.131-99.934-109.131s-82.768,45.369-82.768,45.369V187.333z" /></svg></a>

                    <a class="social-link" href="https://medium.com/@dalamar01977" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 195 195"><path d="M46.5340803,65.2157554 C46.6968378,63.6076572 46.0836,62.018231 44.8828198,60.93592 L32.6512605,46.2010582 L32.6512605,44 L70.6302521,44 L99.9859944,108.380952 L125.794585,44 L162,44 L162,46.2010582 L151.542017,56.2281011 C150.640424,56.9153477 150.193188,58.0448862 150.380019,59.1628454 L150.380019,132.837155 C150.193188,133.955114 150.640424,135.084652 151.542017,135.771899 L161.755369,145.798942 L161.755369,148 L110.38282,148 L110.38282,145.798942 L120.963119,135.527337 C122.002801,134.487948 122.002801,134.182246 122.002801,132.592593 L122.002801,73.0417402 L92.585901,147.755438 L88.6106443,147.755438 L54.3622782,73.0417402 L54.3622782,123.115814 C54.0767278,125.221069 54.7759199,127.3406 56.2581699,128.863022 L70.0186741,145.55438 L70.0186741,147.755438 L31,147.755438 L31,145.55438 L44.7605042,128.863022 C46.2319621,127.338076 46.8903838,125.204485 46.5340803,123.115814 L46.5340803,65.2157554 Z"/></svg></a>
        </div>  
            
      </div>

    </nav>  

  </div>
</header>

<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    
      <article class="post-full post"> 
    <header class="post-full-header">
        <section class="post-full-meta">
            <time class="post-full-meta-date" datetime="2016-09-25">25 September 2016</time>
                <span class="date-divider">/</span> <a href="https://www.danielsobrado.com/tags/tensorflow/">#Tensorflow</a>&nbsp;<a href="https://www.danielsobrado.com/tags/pytorch/">#Pytorch</a>&nbsp;
        </section>
        <h1 class="post-full-title">Tensorflow vs Pytorch: Basics</h1>
    </header>
    
    <figure class="post-full-image" style="background-image: url(https://i.imgur.com/k3fRAC4.jpg)">
    </figure>

    <section class="post-full-content">
        <div class="kg-card-markdown">
        

<h1 id="introduction">Introduction</h1>

<p>The best way to learn a framework is to learn two at the same time and compare how things are being achieved in different ways, understanding the advantages and disadvantages.</p>

<p>Tensorflow and Pytorch are frameworks for fast tensor manipulation that is what is required for deep learning and some other machine learning methods.</p>

<p>Both heavily oriented towards machine learning and especially deep learning are low-level libraries to operate on tensors (n-dimensional arrays).</p>

<p>The beginner data scientist, he usually looks at the higher level APIs and libraries that provide out-of-the-box algorithms ready to apply with the only effort of setting up some hyper-parameters.</p>

<p>For this series we are going to install Tensorflow and Pytorch using Anaconda in Windows together with Jupyter Notebooks:</p>

<pre><code>$ conda create --name ml tensorflow jupyter scikit-learn matplotlib python=3
$ activate ml
$ conda install -c pytorch pytorch
$ pip install jupyter-tensorboard
$ jupyter notebook
</code></pre>

<h2 id="introduction-to-tensorflow">Introduction to Tensorflow</h2>

<p>Tensorflow is Google´s open source solution for computing large amounts of data, it is a symbolic math library based on data-flow programming.</p>

<h3 id="installation">Installation</h3>

<p>You can install Tensorflow using pip or using your favorite virtual environments and package managers like Anaconda or VirtualEnv.</p>

<p>Let´s start with plain pip:</p>

<pre><code>$ pip install tensorflow
</code></pre>

<p>Or the GPU version: (Usually you´ll require CUDA installed)</p>

<pre><code>$ pip install tensorflow-gpu
</code></pre>

<p>Now we´ll install it using Anaconda:</p>

<pre><code>$ conda install tensorflow
$ conda install tensorflow-gpu
</code></pre>

<p>Which one is better? Anaconda makes use of Intel Math Kernel Library for Deep Neural Networks or the MKL-DNN.</p>

<p><img src="https://i.imgur.com/l6ZbUuP.png" alt="" /></p>

<p>Let´s verify the installation:</p>

<pre class="prettyprint lang-py">
import tensorflow as tf
print("Tensorflow version: {}".format(tf.__version__))

<span class="nocode" style="color:white">
Output:
$ Tensorflow version: 1.11.0
</span>
</pre>

<h3 id="tensors">Tensors</h3>

<p>To start with we can consider that Tensor a tensor is a matrix of any order, zero for a sigle value, one for a venctor, two for a matrix&hellip;</p>

<ul>
<li>Boolean:  Boolean (<code>tf.bool</code>).</li>
<li>String:   Variable length (<code>tf.string</code>).</li>
<li>8 bits:   Signed Integer (tf.int8) and Unsigned Integer (<code>tf.uint8</code>).</li>
<li>16 bits:  Integer (<code>tf.int16</code>).</li>
<li>32 bits:  Floating (<code>tf.float32</code>) and Integer (<code>tf.int32</code>).</li>
<li>64 bits:  Floating (<code>tf.float64</code>) and Integer (<code>tf.int64</code>).</li>
<li>Complex 64 and 128 bits: Complex number with real and Imaginary parts, represented by two 64-bit floats (real &amp;
imag. (<code>tf.complex64</code> and <code>tf.complex128</code>)</li>
<li>Quantized Ops 8 and 32 bits: Signed Integer (<code>tf.qint8</code> and <code>tf.qint32</code>) and Unsigned Integer (<code>tf.quint8</code>).</li>
</ul>

<p>It’s possible to change the type of a tensor by using casting functions such as <code>tf.to_double()</code>, <code>tf.to_float()</code>, <code>tf.to_int32()</code>,
<code>tf.to_int64()</code>&hellip;</p>

<p>Tensors have 3 attributes:</p>

<ul>
<li>rank: Number of axes, 0 for a scalar, 1 for a vector, 2 for a matrix&hellip;</li>
<li>shape: The lenght of each axes, for example for a matrix we can have a shape of (2,2).</li>
<li>type: Similar to dtype in Numpy, this is the data type, like uint8, float32, float64 &hellip;</li>
</ul>

<h4 id="create-tensor-with-zeros">Create tensor with zeros</h4>

<p>We can initialize tensors with zeros or ones using the following methods <code>tf.zeros()</code> and <code>tf.ones()</code>:</p>

<pre class="prettyprint lang-py linenums">
tf.zeros(3)

<span class="nocode" style="color:white">
Output:
$ <tf.Tensor 'zeros:0' shape=(3,) dtype=float32>
</span>
</pre>

<p>It is possile to define the type of the values stored in your tensor by using <code>dtype</code>, e.g. <code>tf.zeros((3,3), dtype=tf.int32)</code></p>

<h4 id="evaluate-the-value-of-a-tensor-or-ones">Evaluate the value of a tensor or ones</h4>

<p>Using <code>tf.Tensor.eval()</code> we&rsquo;ll get the value of a tensor evaluated and returned as a numpy array <code>numpy.ndarray</code>.</p>

<pre class="prettyprint lang-py linenums">
tf.InteractiveSession()
all_ones = tf.ones(3)
all_ones.eval()

<span class="nocode" style="color:white">
Output:
$ array([ 1., 1., 1.], dtype=float32)
</span>
</pre>

<p>Note: we need to initialize <code>tf.InteractiveSession()</code> to get the values returned to us during the session.</p>

<h4 id="filling-a-tensor-with-other-values">Filling a tensor with other values</h4>

<p>Using <code>tf.fill</code> you can create a tensor filled with any value:</p>

<pre class="prettyprint lang-py linenums">
all_threes = tf.fill((3, 3), value=3.)
all_threes.eval()

<span class="nocode" style="color:white">
Output:
$ array([[3., 3., 3.],
$        [3., 3., 3.],
$        [3., 3., 3.]], dtype=float32)
</span>
</pre>

<h4 id="filling-with-random-normally-distributed-values">Filling with random normally distributed values</h4>

<p>Using <code>tf.random_normal()</code></p>

<p><code>tf.truncated_normal()</code></p>

<pre class="prettyprint lang-py linenums">
normal_distribution = tf.random_normal((3, 5), mean=0, stddev=1)
normal_distribution.eval()

<span class="nocode" style="color:white">
Output:
$ array([[ 2.0141907 ,  0.5739892 ,  0.35740602,  0.21828577,  1.5545886 ],
$        [-1.4343542 ,  0.8118261 , -0.5939968 , -0.7263036 ,  0.8720175 ],
$        [ 0.16085641, -0.0033439 , -0.45639333, -0.5825363 , -1.1458815 ]],
$       dtype=float32)
</span>
</pre>

<p>You can also use <code>tf.random_uniform()</code></p>

<h4 id="tensor-operations">Tensor operations</h4>

<p>We can perform multiple operations in our tensors:</p>

<ul>
<li>Adding, substracting, multiplying and dividing is done with simple operations</li>
<li>Creating an identity matrix by using <code>tf.eye</code>, this matrix has all its values as zeros except the diagonal that are ones.</li>
<li>Matrix transpose <code>tf.matrix_transpose</code> and matrix multiplication <code>tf.matmul</code>.</li>
</ul>

<pre class="prettyprint lang-py linenums">
normal_distribution = tf.random_normal((2, 2), mean=0, stddev=1)
normal_distribution.eval()

<span class="nocode" style="color:white">
Output:
$ array([[-0.73437649, -0.77678096],
$ [ 0.51697761, 1.15063596]], dtype=float32)
</span>
</pre>

<h3 id="constants">Constants</h3>

<p>Using <code>tf.constant</code></p>

<pre class="prettyprint lang-py linenums">
a = tf.constant(4)
a.eval()


<span class="nocode" style="color:white">
Output:
$ 4

</span>
</pre>

<h3 id="placeholders">Placeholders</h3>

<p>Placeholders are use to feed external data into a graph, we don&rsquo;t need to initialize them.</p>

<p>The size of a placeholder is dynamic, can change during the execution.</p>

<p>We use feed_dict to feed data into the placeholders.</p>

<p>You can provide values for placeholders defined earlier to the session as python dictionary where the key is your placeholder name and value can be a list.</p>

<pre class="prettyprint lang-py linenums">
a = tf.placeholder(tf.float32)
b = a+5
with tf.Session() as session:
    result = session.run(y, feed_dict={x: [1, 2, 3]})

print(result)
<span class="nocode" style="color:white">
Output:
$ 
</span>
</pre>

<p>When we don&rsquo;t know the number of rows, that we are going to feed we can use <strong>None</strong>: x = tf.placeholder(tf.float32, shape=(None,4))</p>

<blockquote>
<p>Placeholders can be the input flows for our neural networks.</p>
</blockquote>

<h3 id="variables">Variables</h3>

<p>Variables in Tensorflow, are similar to variables in standard programming languages, they can be initialized and modified later.</p>

<p>Variables are used to store the state of the graph, they need a value to be initialized during the declaration.</p>

<p>The size of a variable is fixed and specied while constructionf the graph.</p>

<blockquote>
<p>Variables can be the the weights in our neural networks.</p>
</blockquote>

<h3 id="graphs-and-sessions">Graphs and Sessions</h3>

<p>Any Tensorflow program is going to be a Graph, each operation is a function that will be evaluated at that point of the graph.</p>

<p>A graph defines the computation. It doesn’t compute anything by itself, it doesn’t hold any values, it defines the operations specified the code.</p>

<p>Tensorflow uses lazy evaluation (also called call-by-need), in other words, Tensorflow will generate a computational graph that gets executed inside a session.</p>

<pre class="prettyprint lang-py linenums">
x = tf.constant([1,2,3,4])
y = tf.constant([5,6,7,8])

result = tf.multiply(x,y)
session = tf.Session()
print(session.run(result))
session.close()

<span class="nocode" style="color:white">
Output:
$ [ 5 12 21 32]
</span>
</pre>

<p>We´ve seen that we define the session with ´tf.Session´, executed it with ´session.run´ and closed it with ´session.close´.</p>

<p>From TensorFlow v1.5 onwards it is possible to use eager execution.</p>

<pre class="prettyprint lang-py linenums">
x = tf.constant([1,2,3,4])
y = tf.constant([5,6,7,8])
z = tf.mutiply(x, y)

print(z.eval())

<span class="nocode" style="color:white">
Output:
$ [ 5 12 21 32]
</span>
</pre>

<p>A session allows executing graphs and sections of graphs. It allocates resources (distributed or not) and contains the values of intermediate results and variables.</p>

<p>TensorFlow creates a default graph for you, the first two lines of the code are optional.</p>

<p>graph = tf.Graph()
with graph.as_default():</p>

<pre class="prettyprint lang-py linenums">
import tensorflow as tf
x = tf.constant([3])
y = tf.constant([4])
z = tf.add(x,y)
session = tf.Session()
result = session.run(z)
print(result)

<span class="nocode" style="color:white">
Output:
$ [5]
</span>
</pre>

<h3 id="tensorboard">Tensorboard</h3>

<p>Tensorboard is a visualization tool, that will help us understanding, visualizing and debugging our code.</p>

<p>There is handy pupyter extension that we´ll be using to quickly start our tensorboard, it is installed with:</p>

<pre><code>$ pip install jupyter-tensorboard
</code></pre>

<p>We can see our graph with its variables and operations:</p>

<h2 id="introduction-to-pytorch">Introduction to Pytorch</h2>

<p>Pytorch is Facebook&rsquo;s solution for the same problem, a framework to handle large amounts of matricial-like data and leverage on the use of GPUs.</p>

<p>Pytorch is known for its simplicity. It uses Dynamic computation for greater flexibility.</p>

<h3 id="installation-1">Installation</h3>

<p>It is recommended to install Pytorch using Anaconda on its GPU version:</p>

<pre><code>$ conda install pytorch cuda90 
</code></pre>

<p>Or CPU one:</p>

<pre><code>$ conda install pytorch-cpu
</code></pre>

<p>Since PyTorch 0.4.0, there is official Windows Support.</p>

<h3 id="tensors-1">Tensors</h3>

<p>Pytorch provides multiple data abstractions for Tensors:</p>

<ul>
<li>Variables: <code>tf.Variable</code></li>
<li>Constants: <code>tf.constant</code></li>
<li>Placeholders: <code>tf.placeholder</code></li>
<li>Sparse Tensors: <code>tf.SparseTensor</code></li>
</ul>

<p>Tensors are similar to numpy arrays but they have GPU support and methods to switch between CPU and GPU.</p>

<p>We can slice tensors using the notation &lsquo;tensor[:slice index]&lsquo;.</p>

<p>We can find the shape of a Tensor using <code>tf.shape()</code> and change it using <code>tf.reshape()</code>:</p>

<pre class="prettyprint lang-py linenums">
import tesorflow as tf 
a = tf.Variable("String Tensor", tf.string)
print(tf.shape(a))

<span class="nocode" style="color:white">
Output:
$ <tf.Tensor 'Shape:0' shape=(0,) dtype=int32>
</span>

b = tf.Variable([1,2], tf.int32)
print(tf.shape(b))

<span class="nocode" style="color:white">
Output:
$ Tensor("Shape_1:0", shape=(1,), dtype=int32)
</span>

c = tf.Variable([[1,2], [3.1, 4]])
print(tf.shape(c))
<span class="nocode" style="color:white">
Output:
$ Tensor("Shape_3:0", shape=(2,), dtype=int32)
</span>
d = tf.reshape(c,[1,4])
print(d)
<span class="nocode" style="color:white">
Output:
$ Tensor("Reshape_3:0", shape=(1, 4), dtype=float32)
</span>
</pre>

<p>Tensors can contain elements of a single data type, the types supported are:</p>

<ul>
<li>64 bits: Floating (<code>torch.float64</code> or <code>torch.double</code>) and Integer (<code>torch.int64</code> or <code>torch.long</code>)</li>
<li>32 bits: Floating (<code>torch.float32</code> or <code>torch.float</code>) and Integer (<code>torch.int32</code> or <code>torch.int</code>)</li>
<li>16 bits: Floating (<code>torch.float16</code> or <code>torch.half</code>) and Integer (<code>torch.int16</code> or <code>torch.short</code>)</li>
<li>8 bits: Integer Signed (<code>torch.int8</code>) and Unsigned (<code>torch.uint8</code>)</li>
</ul>

<pre class="prettyprint lang-py linenums">
import torch
x = torch.Tensor([3])
y = torch.Tensor([4])
z = x+y
print(z)  

<span class="nocode" style="color:white">
Output:
 7
[torch.FloatTensor of size 1]
</span>
</pre>

<h1 id="hello-world">Hello world!</h1>

<p>Let´s do the typical hello world program in Tensorflow:</p>

<pre class="prettyprint lang-py linenums">
import tensorflow as tf
hello = tf.constant("Hello world!")
session = tf.Session()
print(session.run(hello))
<span class="nocode" style="color:white">
Output:
b'Hello world!'
</span>
</pre>

<p>And now in Pytorch, uppps! We don´t have String tensors in Pytorch, should we do 2+2 instead?</p>

<pre class="prettyprint lang-py linenums">
import torch
a = torch.Tensor([2])
print(a+a)
<span class="nocode" style="color:white">
Output:
tensor([4.])
</span>
</pre>

<h1 id="let-s-implement-rmse">Let&rsquo;s implement RMSE</h1>

<p>Root Mean Square Error (RMSE) is one of the most used loss functions in Deep Learning.</p>

<p>Where Y is the true or reference sample and Y_hat is the predicted result:</p>

<p>$$ RMSE = \sqrt{\Sigma_{i=1}^{n}{\frac{(\hat{y_i} - y_i)^2}{n}}} $$</p>

<h4 id="rmse-using-numpy">RMSE using numpy</h4>

<p>We can use plain python with numpy, to calculate RMSE, we can see it is complete calculation step by step:</p>

<pre class="prettyprint lang-py linenums">
import numpy as np
def rmse(y, y_hat):
​    y_actual=np.array(y)
​    y_pred=np.array(y_hat)
​    error=(y_actual-y_pred)**2
​    error_mean=round(np.mean(error))
​    error_sqrt=sqrt(error_mean)
​    return error_sqrt
</pre>

<h4 id="rmse-using-scikit-learn">RMSE using scikit-learn</h4>

<p>With the help of scikit-learn we can save time and lines of code by using:</p>

<pre class="prettyprint lang-py linenums">
import numpy as np
from sklearn import metrics

def rmse(y, y_hat):
​    return np.sqrt(metrics.mean_squared_error(y, y_hat))
</pre>

<h4 id="rmse-using-tensorflow">RMSE using Tensorflow</h4>

<p>The implementation of Tensorflow doesn&rsquo;t look too different to the one in scikit-learn, but in this case we are running it into a graph and session and this can be distributed and take advantage of the GPU:</p>

<pre class="prettyprint lang-py linenums">
import tensorflow as tf
def rmse(y, y_hat):
​    return tf.sqrt(tf.reduce_mean(tf.square((y - y_hat))))
</pre>

<h4 id="rmse-using-pytorch">RMSE using Pytorch</h4>

<p>Pretty much the same with Pytorch:</p>

<pre class="prettyprint lang-py linenums">
import torch
def rmse(y, y_hat):
​    return torch.sqrt(torch.mean((y - y_hat).pow(2)))
</pre>

<h4 id="comparison">Comparison</h4>

<p>We&rsquo;ve seen the basics of Tensorflow and Pytorch and apart for the syntaxes they don&rsquo;t look so different, the main differences will come later, these are the foundations to start playing with them.</p>

<p>Tensorflow uses <em>static graphs</em> that means you define the graphs and runs them, PyTorch is popular because you can define the graph during the execution, this is called <em>dynamic graphs</em>, we&rsquo;ll see this later in detail.</p>

<p>We&rsquo;ve also implemented one common loss function in several ways.</p>

<p>You can also use a library like StatsModels and use it&rsquo;s own implementation: <a href="http://www.statsmodels.org/devel/generated/statsmodels.tools.eval_measures.rmse.html#statsmodels.tools.eval_measures.rmse">RMSE</a></p>

<p>And investigate in github, how this has been <a href="https://github.com/statsmodels/statsmodels/blob/d7936886235aadf1f3ccf1fafb2411a0c1219da5/statsmodels/tools/eval_measures.py">implemented</a>.</p>

<p>You can find valuable tips like:</p>

<blockquote>
<p>This uses <code>numpy.asanyarray</code> to convert the input. Whether this is the desired result or not depends on the array subclass, for  example numpy matrices will silently produce an incorrect result.</p>
</blockquote>
    
        </div>
    </section>

    <footer class="post-full-footer">
      <section class="author-card">
        <img class="author-profile-image" src="https://www.danielsobrado.com/img/ghost-icon.png" alt="Author" />
        <section class="author-card-content">
            <h4 class="author-card-name"><a href="https://www.danielsobrado.com/">Daniel Sobrado</a></h4>
                <p>Daniel Sobrado</p>
        </section>
      </section>
    </footer>
</article>
    
    
    

<div id="disqus_thread"></div>
<script>




var disqus_config = function () {
this.page.url = "https:\/\/www.danielsobrado.com\/post\/tensorflow-vs-pytorch-basics\/";  
this.page.identifier = "https:\/\/www.danielsobrado.com\/post\/tensorflow-vs-pytorch-basics\/"; 
};

(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://dalamarsblog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  </div>
</main>


<aside class="read-next outer">
  <div class="inner">
    <div class="read-next-feed">      
      
<article class="read-next-card" 
            style="background-image: url(https://www.danielsobrado.com/img/blog-cover.jpg);" >
    <header class="read-next-card-header">
        <small class="read-next-card-header-sitetitle">&mdash; Daniel Sobrado &mdash;</small>
        
        <h3 class="read-next-card-header-title"><a href="https://www.danielsobrado.com/tags/tensorflow/">#Tensorflow</a></h3>
    </header>
    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
    </div>

    <div class="read-next-card-content">
      
        <ul>
          <li><a href="https://www.danielsobrado.com/post/lets-discuss-microservices/">Let&#39;s discuss Microservices</a></li>            
        
          <li><a href="https://www.danielsobrado.com/post/worldbank-datasets-jobs-and-economic-indicators/">Worldbank datasets: Jobs and economic indicators</a></li>            
        
          <li><a href="https://www.danielsobrado.com/post/kaggle-mercari-competition/">Kaggle: Mercari competition</a></li>            
        
          <li><a href="https://www.danielsobrado.com/post/numpy-doing-some-maths/">Numpy: Doing some maths</a></li>            
        </ul>
    </div>
    <footer class="read-next-card-footer">
      
        <a href="https://www.danielsobrado.com/tags/tensorflow/">See all related posts →</a>
    </footer>
</article>


      
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="https://www.danielsobrado.com/post/apache-spark-introduction-to-project-tungsten/">
      <div class="post-card-image" style="background-image: url(https://i.imgur.com/Ous3FT6.jpg)"></div>
    </a>
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="https://www.danielsobrado.com/post/apache-spark-introduction-to-project-tungsten/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #Spark  </span>
              
              <h2 class="post-card-title">Apache Spark: Introduction to project Tungsten</h2>
          </header>
          <section class="post-card-excerpt">
               
                <p>The goal of Project Tungsten is to improve Spark execution by optimizing Spark jobs for CPU and memory efficiency, as opposed to network and disk I/O which are considered fast enough, it&rsquo;s a Spark SQL component that provides more efficient Spark operations by working directly at the byte level.</p>
              
          </section>
      </a>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="https://www.danielsobrado.com/img/ghost-icon.png" alt="Author" />
          <span class="post-card-author"><a href="https://www.danielsobrado.com/">Daniel Sobrado</a></span>
      </footer>
    </div>
</article>
      
      
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="https://www.danielsobrado.com/post/likelihood-encoding/">
      <div class="post-card-image" style="background-image: url(https://i.imgur.com/isyQF4V.jpg)"></div>
    </a>
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="https://www.danielsobrado.com/post/likelihood-encoding/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #Loss Functions  </span>
              
              <h2 class="post-card-title">Likelihood encoding</h2>
          </header>
          <section class="post-card-excerpt">
               
                <p>Likelihood encoding of categorical features</p>
              
          </section>
      </a>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="https://www.danielsobrado.com/img/ghost-icon.png" alt="Author" />
          <span class="post-card-author"><a href="https://www.danielsobrado.com/">Daniel Sobrado</a></span>
      </footer>
    </div>
</article>
      
    </div>
  </div>
</aside>

<div class="floating-header">
  <div class="floating-header-logo">
    <a href="https://www.danielsobrado.com/">
      <img src="https://www.danielsobrado.com/img/daniel-logo.png" alt="" />
      <span></span>
    </a>
  </div>
  <span class="floating-header-divider">&mdash;</span>
  <div class="floating-header-title">Tensorflow vs Pytorch: Basics</div>
  <div class="floating-header-share">
    <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
     <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/></svg>
    </div>
    
    <a class="floating-header-share-tw" href="https://twitter.com/share?text=Tensorflow%20vs%20Pytorch%3a%20Basics&amp;url=https%3a%2f%2fwww.danielsobrado.com%2fpost%2ftensorflow-vs-pytorch-basics%2f"
          onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
      </a>
      <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.danielsobrado.com%2fpost%2ftensorflow-vs-pytorch-basics%2f"
          onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
      </a>
  </div>

  <progress class="progress" value="0">
    <div class="progress-container">
      <span class="progress-bar"></span>
    </div>
  </progress>
</div>



<footer class="site-footer outer">
  <div class="site-footer-content inner">
    <section class="copyright" style="line-height: 1.3em;">
      <a href="https://www.danielsobrado.com/">Daniel Sobrado</a> © 2018 <br>
      <span style="font-size: 0.8em; color: #555;">Hugo port of <a href="https://github.com/TryGhost/Casper">Casper 2.1.7</a> by <a href="https://www.telematika.org">EM</a></span>
    </section>
    <nav class="site-footer-nav">
        <a href="https://www.danielsobrado.com/">Latest Posts</a>
        <a href="https://www.kaggle.com/danielsobrado" target="_blank" rel="noopener">Kaggle</a>
        <a href="https://www.quora.com/profile/Daniel-Sobrado" target="_blank" rel="noopener">Quora</a>
        <a href="https://www.stackoverflow.com//users/2507462/daniel-sobrado" target="_blank" rel="noopener">Stack Overflow</a>
        <a href="https://github.com/danielsobrado" target="_blank" rel="noopener">Github</a>
        <a href="https://www.linkedin.com/in/dsobrado" target="_blank" rel="noopener">LinkedIn</a>
        <a href="https://medium.com/@dalamar01977" target="_blank" rel="noopener">Medium</a>
        <a href="https://twitter.com/DalamarBlog" target="_blank" rel="noopener">Twitter</a>
        <a href="https://www.instagram.com/daniel.sobrado" target="_blank" rel="noopener">Instagram</a>
        <a href="https://www.facebook.com/j.daniel.sobrado" target="_blank" rel="noopener">Facebook</a>
    </nav>  
  </div>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script></footer>
<script>renderMathInElement(document.body,{delimiters:
  [{left: "$", right: "$", display: false},
  {left: "$$", right: "$$", display: true},
  {left: "\\(", right: "\\)", display: false},
  {left: "\\[", right: "\\]", display: true}
  ]
});</script>
</div>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="https://www.danielsobrado.com/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

<script>hljs.initHighlightingOnLoad();</script>



    <script>





$(document).ready(function () {
    
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>
</body></html>
